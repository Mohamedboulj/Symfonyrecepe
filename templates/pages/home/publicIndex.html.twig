{% extends 'base.html.twig' %}

{% block title %}Symrecepe - Mes Recipes {% endblock %}

{% block body %}
    <div class="container">
        <h2 class="my-3">Les Recettes publiques : </h2>
        {% for message in app.flashes('success') %}
            <div class="alert alert-dismissible alert-success">
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                <h5>{{ message }}</h5>
            </div>
        {% endfor %}
        {% for message in app.flashes('warning') %}
            <div class="alert alert-dismissible alert-danger">
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                <h5>{{ message }}</h5>
            </div>
        {% endfor %}
        {% if not recipes.items is same as ([]) %}
        <div class="d-flex justify-content-between my-4">
            <div class="count">
                <h5>{{ recipes.getTotalItemCount }} recette(s) trouvée(s) .</h5>
            </div>
            <div>
                <form class="d-flex" action="{{ path('recipe.search') }}">
                    <input class="form-control me-sm-2" type="search" name="query" placeholder="Rechercher une recette">
                    <button class="btn btn-secondary my-2 my-sm-0" type="submit">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-search" viewBox="0 0 16 16">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>

        <div class="d-flex flex-wrap justify-content-around">
            {% set i = 1 %}
            {% for recipe in recipes %}
                <div class="card bg-light mb-3 col-lg-3 mx-1">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5>Recette N°{{ recipe.id }} </h5>
                        {# {% for rate in recipe.rates %}
                            {{ rate.rate }}
                        {% endfor %} #}
                        <span class="bg-primary rounded-pill badge">{{ recipe.getAverage() }}</span>
                        <p></p>
                        <a href={{ path('recipe.show',{id:recipe.id}) }}>
                            <button class="btn btn-light">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                     fill="currentColor" class="bi bi-eye-fill text-primary" viewBox="0 0 16 16">
                                    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
                                    <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
                                </svg>
                            </button>
                        </a>
                    </div>
                    <div class="card-body">
                        <h4 class="card-title">{{ recipe.name }}</h4>
                        <p class="card-text">{{ recipe.description|slice(0,100) ~ '...' }}</p>
                    </div>
                </div>
            {% endfor %}
            {% else %}
                <div class="count">
                    <h5>No recipes were found .</h5>
                </div>
            {% endif %}
        </div>
        <div class="navigation d-flex justify-content-center">
            {{ knp_pagination_render(recipes) }}
        </div>
    </div>
{% endblock %}
